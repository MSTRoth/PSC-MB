vColor = "roundbill", type = "index", title = "Civilian Services Contracts in FY18",
fontsize.title = 24, fontcolor.labels = c("black","black"), fontsize.labels = c(14,8),
fontface.labels = c("bold","bold"), bg.labels = 0, palette = rev(palette),
align.labels = list(c("center","top"),c("center", "bottom")), lowerbound.cex.labels = .6,
force.print.labels = T, position.legend = "none", aspRatio = 1.9)
dev.off()
treemap(data17, index = c("roundbill", "DPAP.Category"), vSize = "Spend",
vColor = "roundbill", type = "index", title = "Civilian Services Contracts in FY18",
fontsize.title = 24, fontcolor.labels = c("black","black"), fontsize.labels = c(20,12),
fontface.labels = c("bold","bold"), bg.labels = 0, palette = rev(palette),
align.labels = list(c("center","top"),c("center", "bottom")), lowerbound.cex.labels = .6,
force.print.labels = T, position.legend = "none", aspRatio = 1.9)
dev.off()
jpeg(filename="tree.jpeg",width=1300, height=800)
palette <- c("#1455B2", "#5887CD", "#8CA9D5", "#5EA909", "#86E377",
"#88D822","#EDDC11","#EDC511", "#C4A82B")
treemap(data17, index = c("roundbill", "DPAP.Category"), vSize = "Spend",
vColor = "roundbill", type = "index", title = "Civilian Services Contracts in FY18",
fontsize.title = 24, fontcolor.labels = c("black","black"), fontsize.labels = c(20,12),
fontface.labels = c("bold","bold"), bg.labels = 0, palette = rev(palette),
align.labels = list(c("center","top"),c("center", "bottom")), lowerbound.cex.labels = .6,
force.print.labels = T, position.legend = "none", aspRatio = 1.9)
dev.off()
jpeg(filename="tree.jpeg",width=1500, height=800)
palette <- c("#1455B2", "#5887CD", "#8CA9D5", "#5EA909", "#86E377",
"#88D822","#EDDC11","#EDC511", "#C4A82B")
treemap(data17, index = c("roundbill", "DPAP.Category"), vSize = "Spend",
vColor = "roundbill", type = "index", title = "Civilian Services Contracts in FY18",
fontsize.title = 24, fontcolor.labels = c("black","black"), fontsize.labels = c(30,20),
fontface.labels = c("bold","bold"), bg.labels = 0, palette = rev(palette),
align.labels = list(c("center","top"),c("center", "bottom")), lowerbound.cex.labels = .6,
force.print.labels = T, position.legend = "none", aspRatio = 1.9)
dev.off()
jpeg(filename="tree.jpeg",width=1500, height=1000)
palette <- c("#1455B2", "#5887CD", "#8CA9D5", "#5EA909", "#86E377",
"#88D822","#EDDC11","#EDC511", "#C4A82B")
treemap(data17, index = c("roundbill", "DPAP.Category"), vSize = "Spend",
vColor = "roundbill", type = "index", title = "Civilian Services Contracts in FY18",
fontsize.title = 24, fontcolor.labels = c("black","black"), fontsize.labels = c(30,20),
fontface.labels = c("bold","bold"), bg.labels = 0, palette = rev(palette),
align.labels = list(c("center","top"),c("center", "bottom")), lowerbound.cex.labels = .6,
force.print.labels = T, position.legend = "none", aspRatio = 1.9)
dev.off()
data <- read_csv(paste("X:/1 Marielle Folder/Data For R/Contract Obligation by Agency/Company Profiles/", "Halfaker and Associates",
" Company Profile.csv", sep = ""))
setwd("~/Reference Tables")
setwd("~/Reference Tables")
setwd("~/Reference Tables")
crosswalk <- read_csv("PSC RandD, S, P.csv")
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`)
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`,
fy = `Fiscal Year`) %>%
filter(fy>=2014 & fy<=2017)
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`,
fy = `Fiscal Year`) %>%
filter(fy>=2014 & fy<=2017) %>%
left_join(crosswalk, by = c("PSC","PSC Code"))
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`,
fy = `Fiscal Year`) %>%
filter(fy>=2014 & fy<=2017) %>%
left_join(crosswalk, by = c("PSC"="PSC Code"))
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`,
fy = `Fiscal Year`) %>%
filter(fy>=2014 & fy<=2017) %>%
left_join(crosswalk, by = c("PSC"="PSC CODE"))
View(dataH)
crosswalk <- read_csv("PSC RandD, S, P.csv")
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`,
fy = `Fiscal Year`) %>%
filter(fy>=2014 & fy<=2017) %>%
left_join(crosswalk, by = c("PSC"="PSC CODE"))
data.agency.year1 <- process.data.get.sum(dataH, "Department of Defense (DOD)", "Funding Agency", FY = 2018, 1000000)
library(pscMB)
devtools::load_all()
setwd("~/PSC-MB")
devtools::load_all()
roxygen2::roxygenise()
data.agency.year1 <- process.data.get.sum(dataH, "Department of Defense (DOD)", "Funding Agency", FY = 2018, 1000000)
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
filter(`Fiscal Year`>=2014 & `Fiscal Year`<=2017) %>%
left_join(crosswalk, by = c("PSC"="PSC CODE"))
library(pscMB)
data.agency.year1 <- process.data.get.sum(dataH, "Department of Defense (DOD)", "Funding Agency", FY = 2018, 1000000)
library(PSCmb)
View(data.agency.year1)
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1$fiscal_year = as.character(data.agency.year1$fiscal_year)
data.agency.year2 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Veterans Affairs (VA)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year2$fiscal_year = as.character(data.agency.year2$fiscal_year)
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau"
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Centers for Medicare and Medicaid Services (CMS)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year3$fiscal_year = as.character(data.agency.year3$fiscal_year)
data.agency.year4 <- dataH %>%
select("Fiscal Year", "Funding Office Level 3", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Office Level 3",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Defense Health Agency (DHA)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year4$fiscal_year = as.character(data.agency.year4$fiscal_year)
crosswalk <- read_csv("PSC RandD, S, P.csv")
setwd("~/Reference Tables")
crosswalk <- read_csv("PSC RandD, S, P.csv")
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
filter(`Fiscal Year`>=2014 & `Fiscal Year`<=2017) %>%
left_join(crosswalk, by = c("PSC"="PSC CODE"))
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1$fiscal_year = as.character(data.agency.year1$fiscal_year)
data.agency.year2 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Veterans Affairs (VA)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year2$fiscal_year = as.character(data.agency.year2$fiscal_year)
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau"
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Centers for Medicare and Medicaid Services (CMS)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year3$fiscal_year = as.character(data.agency.year3$fiscal_year)
data.agency.year4 <- dataH %>%
select("Fiscal Year", "Funding Office Level 3", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Office Level 3",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Defense Health Agency (DHA)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year4$fiscal_year = as.character(data.agency.year4$fiscal_year)
plot1 <- ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
library(ggrepel)
plot1 <- ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
plot1 <- ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
plot1 <- ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") #+
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1$fiscal_year = as.character(data.agency.year1$fiscal_year)
data.agency.year2 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Veterans Affairs (VA)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year2$fiscal_year = as.character(data.agency.year2$fiscal_year)
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau"
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Centers for Medicare and Medicaid Services (CMS)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year3$fiscal_year = as.character(data.agency.year3$fiscal_year)
data.agency.year4 <- dataH %>%
select("Fiscal Year", "Funding Office Level 3", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Office Level 3",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Defense Health Agency (DHA)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year4$fiscal_year = as.character(data.agency.year4$fiscal_year)
###Create Barplot and Save as JPG
plot1 <- plot.first(data.agency.year1, "funding_agency", 3, "Millions")
plot2 <- plot.middle(data.agency.year2, "funding_agency", 3)
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data <- read_csv(paste("X:/1 Marielle Folder/Data For R/Contract Obligation by Agency/Company Profiles/", "Halfaker and Associates",
" Company Profile.csv", sep = ""))
setwd("~/Reference Tables")
crosswalk <- read_csv("PSC RandD, S, P.csv")
dataH <- data %>%
select(`Fiscal Year`, `Transaction Value`,
`Funding Agency`, `Funding Bureau`, `Funding Office Level 3`,
`Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
rename(PSC = `Product Service Code (PSC) / Federal Supply Code (FSC)`) %>%
filter(`Fiscal Year`>=2014 & `Fiscal Year`<=2017) %>%
left_join(crosswalk, by = c("PSC"="PSC CODE"))
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1$fiscal_year = as.character(data.agency.year1$fiscal_year)
data.agency.year2 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Veterans Affairs (VA)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year2$fiscal_year = as.character(data.agency.year2$fiscal_year)
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau"
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Centers for Medicare and Medicaid Services (CMS)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year3$fiscal_year = as.character(data.agency.year3$fiscal_year)
data.agency.year1 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Defense (DOD)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year1$fiscal_year = as.character(data.agency.year1$fiscal_year)
data.agency.year2 <- dataH %>%
select("Fiscal Year", "Funding Agency", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Agency",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Department of Veterans Affairs (VA)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year2$fiscal_year = as.character(data.agency.year2$fiscal_year)
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau"
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Centers for Medicare and Medicaid Services (CMS)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau"
transaction_value = "Transaction Value",
PSC = "Product or Service")
data.agency.year3 <- dataH %>%
select("Fiscal Year", "Funding Bureau", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Bureau",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Centers for Medicare and Medicaid Services (CMS)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year3$fiscal_year = as.character(data.agency.year3$fiscal_year)
data.agency.year4 <- dataH %>%
select("Fiscal Year", "Funding Office Level 3", "Transaction Value", "Product or Service") %>%
dplyr::rename(fiscal_year = "Fiscal Year",
funding_agency = "Funding Office Level 3",
transaction_value = "Transaction Value",
PSC = "Product or Service") %>%
filter(fiscal_year != 2018) %>%
filter(funding_agency == "Defense Health Agency (DHA)") %>%
dplyr::group_by(funding_agency, fiscal_year, PSC) %>%
dplyr::summarize(total_transaction_value = (sum(transaction_value)/1000000))
data.agency.year4$fiscal_year = as.character(data.agency.year4$fiscal_year)
###Create Barplot and Save as JPG
plot1 <- plot.first(data.agency.year1, "funding_agency", 3, "Millions")
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity")
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
#geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = paste("Contract Obligations (in Millions)", sep = "")) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
#geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1", "Services" = "goldenrod1", "R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = "Contract Obligations (in Millions)") +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
dev.off()
ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
#geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1",
"Services" = "goldenrod1",
"R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = "Contract Obligations (in Millions)") +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
plot1<-ggplot(data.agency.year1, aes(x = fiscal_year, y = total_transaction_value, fill = PSC)) +
geom_bar(position = "stack", stat = "identity") +
#geom_text_repel(aes(label = round(total_transaction_value, digits = 1), vjust = 1.5), size = 3)+
scale_fill_manual("Products and Services", values = c("Products" = "seagreen1",
"Services" = "goldenrod1",
"R&D" = "firebrick1")) +
#facet_grid(noquote(paste("~",facet_var, sep = "")), labeller = label_wrap_gen(20))+
labs(y = "Contract Obligations (in Millions)") +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.title.x=element_blank())
ggsave("Contract Obligations by Agency.jpg", plot1,
width = 10, height = 6, units = "in")
View(dataH)
View(data.agency.year2)
View(data.agency.year3)
View(data.agency.year4)
View(data.agency.year1)
View(data.agency.year2)
View(data.agency.year3)
View(dataH)
setwd("~/PSC-MB")
devtools::load_all()
roxygen2::roxygenise()
devtools::load_all()
roxygen2::roxygenise()
roxygen2::roxygenise()
devtools::load_all()
roxygen2::roxygenise()
