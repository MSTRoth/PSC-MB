axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1, size = 3, fontface = "bold")) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%.1f%%', prop)), vjust = 1, size = 3, fontface = "bold")) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%.0f%%', prop)), vjust = 1, size = 3, fontface = "bold")) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1, size = 3, fontface = "bold")) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
#geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1, size = 3, fontface = "bold")) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
data_edit <- data %>%
rename(amount = `Total (in millions)`) %>%
filter(Type != "Products") %>%
filter(Year == "FY17") %>%
mutate(amountB = amount/1000) %>%
group_by(Service) %>%
mutate(prop = 100*amountB/sum(amountB))
data_edit$amountB = as.numeric(data_edit$amountB)
data_edit$Type = factor(data_edit$Type, levels = c("Knowledge Based Services", "Research and Development",
"Equipment Related Services","Facility Related Services",
"Electronic & Communication Services", "Transportation Services",
"Logistics Management Services", "Construction Services",
"Medical Services"))
data_edit$Service[data_edit$Service == "Defense-wide"] = "DoD, Other"
data_edit$Service = factor(data_edit$Service, levels = c("Air Force", "Army", "Navy", "DoD, Other"))
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
geom_text(aes(label = sprintf('%0.1f%', round(amountB, digit = 1)), vjust = -.5, size = 3, fontface = "bold")+
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f%', round(amountB, digit = 1))), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
defense_wide <- data_edit %>%
filter(Service == "Defense-wide")
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f%', round(amountB, digit = 1))), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3) +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 4, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 'bottom', size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 0), vjust = 2, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 0), vjust = -2, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 1), size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 0), size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 0.5), size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 0.25), size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = 0.25), size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), size = 2, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 2, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.5, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.25, size = 3, fontface = "bold") +
scale_fill_manual(data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.25, size = 3, fontface = "bold") +
scale_fill_manual(label = "Services Taxonomy", data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.25, size = 3, fontface = "bold") +
scale_fill_manual(name = "Services Taxonomy", data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop)), vjust = 1.25, size = 3, fontface = "bold") +
scale_fill_manual(name = "Services Taxonomy", data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(data_edit, aes(x = Type , y = amountB, fill = Type)) +
geom_bar(stat = "identity") +
geom_text(aes(label = sprintf('%0.1f', round(amountB, digit = 1))), vjust = -.5, size = 3.5, fontface = "bold")+
geom_text(aes(label = sprintf('%0.1f%%', prop), y = .25), size = 3, fontface = "bold") +
scale_fill_manual(name = "Services Taxonomy", data_edit$Type, values = c("Knowledge Based Services" = "mediumorchid3", "Research and Development" = "mediumseagreen",
"Equipment Related Services" = "firebrick1","Facility Related Services" = "goldenrod2",
"Electronic & Communication Services" = "steelblue3", "Transportation Services" = "palevioletred1",
"Logistics Management Services" = "lightseagreen", "Construction Services" = "olivedrab2",
"Medical Services" = "orangered1")) +
#scale_fill_manual(Type, palette = "Dark1") +
facet_grid(~Service, scales = "free_x", drop = TRUE) +   #labeller = label_wrap_gen(20)) +
#scale_x_discrete(labels = molten[, setNames(as.character(id), ord)])+
labs(y="Amount (in Billions)", title = "DoD Services Taxonomy by Branch")+
theme(plot.title = element_text(hjust = 0.5, size = 24, face = "bold"), axis.title.x = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank())
roxygen2::roxygenise()
library(gridExtra)
library(grid)
library(ggrepel)
library(tidyverse)
library(svglite)
options(scipen = 999)
bar_primeob_by_agency("Maximus",
FY = 1,
n_agencies = 6,
scale = 1000000,
scale_text = "Millions",
"FY2016 - FY2018",
num_size = 3,
h = 6,
w = 11)
bar_primeob_by_agency("Maximus",
FY = 2018,
n_agencies = 6,
scale = 1000000,
scale_text = "Millions",
"FY2014 - FY2017",
num_size = 3,
h = 6,
w = 11)
bar_primeob_by_agency("Netapp",
FY = 2018,
n_agencies = 6,
scale = 1000000,
scale_text = "Millions",
"FY2014 - FY2017",
num_size = 3,
h = 6,
w = 11)
bar_primeob_by_agency("Netapp",
FY = 2018,
n_agencies = 6,
scale = 1000,
scale_text = "Thousands",
"FY2014 - FY2017",
num_size = 3,
h = 6,
w = 11)
